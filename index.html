<script src='lib/system.src.js'></script>
<script>
function _foo(_export) {
	var __moduleName = 'foo';
	
	function foo(str) {
		return str + '!';
	}
	return {
		setters: [function (m) {
		}],
		execute: function () {
			_export('default', foo);
		}
	};
}

function _bar(_export) {
	'use strict';

	var __moduleName = 'bar';

	var foo;
	function bar() {
		return foo('foobar');
	}
	return {
		setters: [function (m) {
			foo = m.default;
		}],
		execute: function () {
			_export('bar', bar);
		}
	};
}

// Register modules for the first time
System.register('foo', [], _foo);
System.register('bar', ['foo'], _bar);

// import 'bar'
System.import('bar').then(function(module) {
	console.log(module.bar());
	
	// delete all modules
	System.delete('foo');
	System.delete('bar');
	
debugger;
	// Register exactly the same modules a subsequent time
	System.define('foo', "function(str) { return str + '!'; }");
	System.define('bar', "function() { var foo = System.get('foo'); return foo('foobar'); }");
	
	// import 'bar' again (ERROR!)
	System.import('bar').then(function(module) {
		console.log(module.bar());
	});
});
</script>
