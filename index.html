<script src='lib/system.src.js'></script>
<script>
function createRegisterFunc(name, func) {
	return function(_export) {
		return {
			setters: [function (m) {
			}],
			execute: function () {
				_export(name, func);
			}
		};
	};
}

var _foo = createRegisterFunc('default', function foo(str) {
	return str + '!';
})

var _updatedFoo = createRegisterFunc('default', function foo(str) {
	return str + '?';
})

function _bar(_export) {
	'use strict';

	var __moduleName = 'bar';

	var foo;
	function bar() {
		return foo('foobar');
	}
	return {
		setters: [function (m) {
			foo = m.default;
		}],
		execute: function () {
			_export('bar', bar);
		}
	};
}

// Register modules for the first time
System.register('foo', [], _foo);
System.register('bar', ['foo'], _bar);

// import 'bar'
System.import('bar').then(function(module) {
	console.log(module.bar());

	// delete all modules
	System.delete('foo');
	System.delete('bar');

	// Register a new 'foo' module the second time around
	System.register('foo', [], _updatedFoo);
	System.register('bar', ['foo'], _bar);

	// import 'bar' again
	System.import('bar').then(function(module) {
		console.log(module.bar());
	});
});
</script>
